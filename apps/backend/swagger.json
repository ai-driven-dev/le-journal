{
  "openapi": "3.0.0",
  "paths": {
    "/api/users": {
      "post": {
        "operationId": "UsersController_createUser",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateUserDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Utilisateur créé avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserDTO"
                }
              }
            }
          },
          "409": {
            "description": "Un utilisateur avec cet email existe déjà"
          }
        },
        "summary": "Créer un nouvel utilisateur",
        "tags": ["Users"]
      },
      "get": {
        "operationId": "UsersController_getAllUsers",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Liste des utilisateurs récupérée avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/UserDTO"
                  }
                }
              }
            }
          }
        },
        "summary": "Récupérer tous les utilisateurs",
        "tags": ["Users"]
      }
    },
    "/api/projects": {
      "post": {
        "operationId": "ProjectsController_createProject",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateProjectDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectDto"
                }
              }
            }
          }
        },
        "summary": "Créer un nouveau projet",
        "tags": ["Projects"]
      },
      "get": {
        "operationId": "ProjectsController_getProject",
        "parameters": [
          {
            "name": "projectNumber",
            "required": false,
            "in": "query",
            "schema": {
              "default": 1,
              "type": "number"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectDto"
                }
              }
            }
          }
        },
        "summary": "Récupérer le projet de l'utilisateur",
        "tags": ["Projects"]
      }
    },
    "/api/projects/prompt": {
      "put": {
        "operationId": "ProjectsController_updateProjectPrompt",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateProjectPromptDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProjectDto"
                }
              }
            }
          }
        },
        "summary": "Mettre à jour les instructions du prompt du projet",
        "tags": ["Projects"]
      }
    },
    "/api/newsletters": {
      "get": {
        "operationId": "NewsletterController_getNewsletters",
        "parameters": [],
        "responses": {
          "200": {
            "description": "List of newsletter subscriptions retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/NewsletterDto"
                  }
                }
              }
            }
          }
        },
        "summary": "Get all newsletter subscriptions",
        "tags": ["Newsletters"]
      }
    },
    "/api/newsletters/emails": {
      "get": {
        "operationId": "NewsletterController_getAllEmails",
        "parameters": [
          {
            "name": "projectId",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Liste des emails récupérée avec succès",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/EmailDto"
                  }
                }
              }
            }
          }
        },
        "summary": "Récupérer tous les emails de la newsletter",
        "tags": ["Newsletters"]
      }
    },
    "/api/newsletters/emails/search": {
      "get": {
        "operationId": "NewsletterController_searchEmails",
        "parameters": [
          {
            "name": "query",
            "required": true,
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Résultats de la recherche",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/EmailDto"
                  }
                }
              }
            }
          }
        },
        "summary": "Rechercher des emails dans la newsletter",
        "tags": ["Newsletters"]
      }
    }
  },
  "info": {
    "title": "Le Journal API",
    "description": "Documentation de l'API Le Journal",
    "version": "1.0",
    "contact": {}
  },
  "tags": [],
  "servers": [],
  "components": {
    "securitySchemes": {
      "bearer": {
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "type": "http"
      }
    },
    "schemas": {
      "CreateUserDto": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "example": "john.doe@email.com",
            "description": "Email de l'utilisateur"
          },
          "name": {
            "type": "string",
            "example": "John Doe",
            "description": "Nom de l'utilisateur"
          }
        },
        "required": ["email"]
      },
      "UserDTO": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "c123e456-789b-12d3-a456-426614174000",
            "description": "ID de l'utilisateur"
          },
          "email": {
            "type": "string",
            "example": "john.doe@email.com",
            "description": "Email de l'utilisateur"
          },
          "name": {
            "type": "string",
            "example": "John Doe",
            "description": "Nom de l'utilisateur"
          },
          "createdAt": {
            "type": "string",
            "example": "2024-02-08T12:00:00.000Z",
            "description": "Date de création"
          },
          "updatedAt": {
            "type": "string",
            "example": "2024-02-09T14:30:00.000Z",
            "description": "Date de mise à jour"
          }
        },
        "required": ["id", "email", "createdAt", "updatedAt"]
      },
      "CreateProjectDto": {
        "type": "object",
        "properties": {
          "name": {
            "type": "string",
            "example": "Mon super projet",
            "description": "Nom du projet"
          },
          "slug": {
            "type": "string",
            "example": "mon-super-projet",
            "description": "Slug du projet"
          },
          "userId": {
            "type": "string",
            "example": "user-123",
            "description": "ID du propriétaire du projet"
          },
          "newsletterAlias": {
            "type": "string",
            "example": "mon-alias",
            "description": "Alias unique pour les newsletters"
          },
          "projectNumber": {
            "type": "number",
            "example": 1,
            "description": "Numéro du projet"
          }
        },
        "required": ["name", "slug", "userId", "newsletterAlias", "projectNumber"]
      },
      "ProjectDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "c123e456-789b-12d3-a456-426614174000",
            "description": "ID du projet"
          },
          "name": {
            "type": "string",
            "example": "Mon super projet",
            "description": "Nom du projet"
          },
          "slug": {
            "type": "string",
            "example": "mon-super-projet",
            "description": "Slug du projet"
          },
          "userId": {
            "type": "string",
            "example": "user-123",
            "description": "ID du propriétaire du projet"
          },
          "newsletterAlias": {
            "type": "string",
            "example": "mon-alias",
            "description": "Alias unique pour les newsletters"
          },
          "projectNumber": {
            "type": "number",
            "example": 1,
            "description": "Numéro du projet"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string",
            "example": "2024-02-08T12:00:00.000Z",
            "description": "Date de création"
          },
          "promptInstruction": {
            "type": "string",
            "example": "Write a blog post about AI and its impact on society",
            "description": "Instruction pour le projet"
          }
        },
        "required": [
          "id",
          "name",
          "slug",
          "userId",
          "newsletterAlias",
          "projectNumber",
          "createdAt",
          "promptInstruction"
        ]
      },
      "UpdateProjectPromptDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "example": "c123e456-789b-12d3-a456-426614174000",
            "description": "ID du projet"
          },
          "promptInstruction": {
            "type": "string",
            "description": "The instruction prompt for the project",
            "example": "Write a blog post about AI and its impact on society",
            "minLength": 10,
            "maxLength": 200
          }
        },
        "required": ["id", "promptInstruction"]
      },
      "NewsletterDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "The unique identifier of the newsletter subscription",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "user_id": {
            "type": "string",
            "description": "The user ID who subscribed to the newsletter",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "email": {
            "type": "string",
            "description": "The email address subscribed to the newsletter",
            "example": "user@example.com"
          },
          "subscribed_at": {
            "format": "date-time",
            "type": "string",
            "description": "The date when the user subscribed to the newsletter",
            "example": "2024-02-08T20:00:00.000Z"
          },
          "subscription_status": {
            "type": "string",
            "description": "The current status of the newsletter subscription",
            "enum": ["ACTIVE", "IN_PROGRESS", "PENDING", "FAILED"],
            "example": "ACTIVE"
          }
        },
        "required": ["id", "user_id", "email", "subscribed_at", "subscription_status"]
      },
      "ArticleDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique ID of the article",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "subject": {
            "type": "string",
            "description": "Subject or main topic of the article",
            "example": "Building Scalable Backend Services"
          },
          "description": {
            "type": "string",
            "description": "Description of the article content",
            "example": "Learn the best practices for building enterprise-grade NestJS applications..."
          },
          "link": {
            "type": "object",
            "description": "URL to the full article",
            "example": "https://example.com/article/nestjs-best-practices",
            "nullable": true
          },
          "score": {
            "type": "number",
            "description": "Relevance score of the article (0-1)",
            "example": 0.95
          }
        },
        "required": ["id", "subject", "description", "link", "score"]
      },
      "EmailDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "ID unique de l'email",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "project_id": {
            "type": "string",
            "description": "ID du projet associé",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "newsletter_id": {
            "type": "string",
            "description": "ID de la newsletter associée",
            "example": "123e4567-e89b-12d3-a456-426614174000"
          },
          "subject": {
            "type": "string",
            "description": "Sujet de l'email",
            "example": "Newsletter #42 - Les dernières actualités tech"
          },
          "raw_content": {
            "type": "string",
            "description": "Contenu brut de l'email",
            "example": "Contenu de l'email au format texte..."
          },
          "received_at": {
            "format": "date-time",
            "type": "string",
            "description": "Date de réception de l'email",
            "example": "2024-03-20T10:00:00Z"
          },
          "status": {
            "type": "string",
            "description": "Statut de traitement de l'email",
            "enum": ["RECEIVED", "PROCESSED", "FAILED"],
            "example": "RECEIVED"
          },
          "articles": {
            "description": "Articles associés à l'email",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/ArticleDto"
            }
          }
        },
        "required": [
          "id",
          "project_id",
          "newsletter_id",
          "subject",
          "raw_content",
          "received_at",
          "status",
          "articles"
        ]
      }
    }
  }
}
